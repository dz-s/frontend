{"version":3,"sources":["App.styled.ts","Player.styled.ts","Player.tsx","Controls.styled.ts","Controls.tsx","utils.ts","App.tsx","index.tsx"],"names":["AppStyle","styled","div","AppTextStyle","PlayerStyle","PlayerMetaStyle","Player","props","ref","React","createRef","state","autoplay","volume","this","current","node","getVideoNode","muted","setState","playing","play","pause","playsInline","key","source","controls","autoPlay","loop","looping","preload","onPlay","onPause","onEnded","moveCursor","onError","onVolumeChange","poster","style","maxHeight","minHeight","maxWidth","borderRadius","src","name","href","target","textDecoration","Component","ControlsStyle","ControlsTextStyle","Controls","onClick","toggleLoop","color","download","arr","i","length","j","Math","floor","random","App","board","playlist","cursor","document","addEventListener","handleKeyDown","bind","e","tagName","code","delta","BASE","axios","get","threads","data","promisedPosts","map","x","id","then","v","value","status","Promise","all","posts","content","includes","files","filter","flatMap","kind","full","thumbnail","fetchPlaylist","Utils","shuffle","_","prevState","setPlaylist","video","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.0106ae3c.chunk.js","sourcesContent":["import styled from \"styled-components\";\n\nconst AppStyle = styled.div`\n  height: 100%;\n  width: 100%;\n  display: block;\n  margin: 0 auto;\n  text-align: center;\n  overflow: hidden;\n`;\n\nconst AppTextStyle = styled.div`\n  display: inline-block;\n  color: hotpink;\n  letter-spacing: 1px;\n  margin-right: 1rem;\n`;\n\nexport {AppStyle, AppTextStyle};","import styled from \"styled-components\";\n\nconst PlayerStyle = styled.div`\n  position: relative;\n  margin-left: auto;\n  margin-right: auto;\n  margin-top: 2.5vh;\n`;\n\nconst PlayerMetaStyle = styled.div`\n  font-family: \"Roboto\", sans-serif;\n  display: inline-block;\n  margin-right: 1rem;\n`;\n\nexport {PlayerStyle, PlayerMetaStyle};","import React from \"react\";\nimport * as S from \"./Player.styled\";\n\ninterface Props {\n  source: string;\n  name: string;\n  poster: string;\n\n  playing: boolean;\n  looping: boolean;\n\n  onPlay: Function;\n  onPause: Function;\n  moveCursor: Function;\n}\n\ninterface State {\n  autoplay: boolean;\n  volume: number;\n}\n\nclass Player extends React.Component<Props, State> {\n  ref: React.RefObject<HTMLVideoElement>;\n\n  constructor(props: Props) {\n    super(props);\n\n    this.ref = React.createRef<HTMLVideoElement>();\n\n    this.state = {\n      autoplay: false,\n      volume: 1.00,\n    };\n  }\n\n  getVideoNode(): HTMLVideoElement | null {\n    return this.ref.current;\n  }\n\n  onVolumeChange() {\n    const node = this.getVideoNode();\n    if (!node)\n      return;\n\n    if (node.muted)\n      this.setState({volume: 0});\n    else\n      this.setState({volume: node.volume})\n  }\n\n  componentDidUpdate() {\n    if (this.props.playing && !this.state.autoplay)\n      this.setState({autoplay: true});\n\n    const node = this.getVideoNode();\n    if (!node)\n      return;\n\n    this.props.playing ? node.play() : node.pause();\n    node.volume = this.state.volume;\n  }\n\n  render() {\n    return (\n      <S.PlayerStyle>\n        <video\n          playsInline={true}\n          ref={this.ref}\n          key={this.props.source}\n          controls={true}\n          autoPlay={this.state.autoplay}\n          loop={this.props.looping}\n          muted={false}\n          preload={\"auto\"}\n          onPlay={() => this.props.onPlay()}\n          onPause={() => this.props.onPause()}\n          onEnded={() => this.props.moveCursor(1)}\n          onError={() => this.props.moveCursor(1)}\n          onVolumeChange={() => this.onVolumeChange()}\n          poster={this.props.poster}\n          style={\n            {\n              maxHeight: \"70vh\",\n              minHeight: \"40vh\",\n              maxWidth: \"90vw\",\n              borderRadius: \"5px\"\n            }\n          }\n        >\n          <source src={this.props.source}/>\n        </video>\n\n        <S.PlayerMetaStyle>\n          {this.props.name}\n        </S.PlayerMetaStyle>\n\n        <S.PlayerMetaStyle>\n          <a\n            href={`http://www.google.com/searchbyimage?image_url=${this.props.poster}`}\n            target={\"_blank\"}\n            style={{textDecoration: \"none\"}}\n          >\n            {\"🔎\"}\n          </a>\n        </S.PlayerMetaStyle>\n      </S.PlayerStyle>\n    )\n  }\n}\n\n\nexport default Player;\n","import styled from \"styled-components\";\n\nconst ControlsStyle = styled.div`\n  text-align: center;\n  position: fixed;\n  bottom: 5vh;\n  left: 50%;\n  transform: translateX(-50%);\n`;\n\nconst ControlsTextStyle = styled.div`\n  color: hotpink;\n  letter-spacing: 1px;\n  margin-right: 1rem;\n  display: inline-block;\n\n  &:hover {\n    color: orange;\n  }\n  &:link {\n    color: hotpink;\n  }\n  &:visited {\n    color: red;\n  }\n`;\n\nexport {ControlsStyle, ControlsTextStyle};","import React from \"react\";\nimport * as S from \"./Controls.styled\";\n\n\ninterface Props {\n  source: string;\n  playing: boolean;\n  looping: boolean\n\n  moveCursor: Function;\n  toggleLoop: Function;\n}\n\ninterface State {\n}\n\nclass Controls extends React.Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n\n    this.state = {}\n  }\n\n  render() {\n    return (\n      <S.ControlsStyle>\n        <S.ControlsTextStyle>\n                    <span onClick={() => this.props.moveCursor(-1)}>\n                    {\"◀\"}\n                    </span>\n        </S.ControlsTextStyle>\n\n        <S.ControlsTextStyle>\n          |\n        </S.ControlsTextStyle>\n\n        <S.ControlsTextStyle>\n                    <span onClick={() => this.props.moveCursor(1)}>\n                    {\"▶\"}\n                    </span>\n        </S.ControlsTextStyle>\n\n        <br/>\n        <br/>\n\n        <S.ControlsTextStyle>\n          <span onClick={() => this.props.toggleLoop()}\n                style={{color: this.props.looping ? \"hotpink\" : \"orange\"}}>\n            {this.props.looping ? \"LOOPING\" : \"LOOP\"}\n          </span>\n        </S.ControlsTextStyle>\n\n        <S.ControlsTextStyle>\n          <a\n            href={this.props.source}\n            download\n            target={\"_blank\"}\n            style={\n              {\n                color: \"hotpink\",\n                textDecoration: \"none\"\n              }\n            }\n          >\n            DOWNLOAD\n          </a>\n        </S.ControlsTextStyle>\n      </S.ControlsStyle>\n    )\n  }\n}\n\nexport default Controls;","export default class {\n  static shuffle<T>(arr: Array<T>): Array<T> {\n    for (let i = arr.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      [arr[i], arr[j]] = [arr[j], arr[i]];\n    }\n    return arr;\n  }\n}","import React from \"react\";\nimport * as S from \"./App.styled\";\nimport Player from \"./Player\";\nimport Controls from \"./Controls\";\nimport axios from \"axios\";\nimport Utils from \"./utils\";\n\ninterface State {\n  playing: boolean;\n  looping: boolean;\n\n  board: string;\n  playlist: Array<{ source: string; name: string; poster: string }>;\n  cursor: number;\n}\n\nclass App extends React.Component<any, State> {\n  constructor(props: any) {\n    super(props);\n\n    this.state = {\n      playing: false,\n      looping: true,\n      board: \"b\",\n      playlist: [],\n      cursor: 0\n    };\n\n    document.addEventListener(\"keydown\", this.handleKeyDown.bind(this));\n  }\n\n  handleKeyDown(e: KeyboardEvent) {\n    if ((e.target! as HTMLElement).tagName === \"VIDEO\")\n      return;\n\n    switch (e.code) {\n      case \"ArrowLeft\":\n        this.moveCursor(-1);\n        break;\n      case \"ArrowRight\":\n        this.moveCursor(1);\n        break;\n      case \"Space\":\n        this.state.playing ? this.onPause() : this.onPlay();\n        break;\n    }\n  }\n\n  onPlay() {\n    this.setState({playing: true});\n  }\n\n  onPause() {\n    this.setState({playing: false});\n  }\n\n  moveCursor(delta: number) {\n    const cursor = this.state.cursor + delta;\n\n    if (cursor < 0 || cursor >= this.state.playlist.length)\n      return;\n\n    this.setState({cursor: cursor});\n  }\n\n  toggleLoop() {\n    this.setState({looping: !this.state.looping})\n  }\n\n  async fetchPlaylist() {\n    const BASE = `https://one.karasique.io/0/${this.state.board}`;\n\n    const threads = (await axios.get(BASE)).data;\n\n    const promisedPosts = threads\n      .map((x: { id: string; }) =>\n        axios\n          .get(`${BASE}/${x.id}`)\n          .then(\n            (v) => {\n              return {value: v.data, status: 1}\n            },\n            (e) => {\n              return {e: e, status: 0}\n            }\n          )\n      );\n\n    const files = (await Promise.all(promisedPosts))\n      .filter((x: any) => x.status === 1 && x.value.posts.length > 0)\n      .flatMap((x: any) => x.value.posts)\n      .filter(x =>\n        !x.content.includes(\"FAP\") &&\n        !x.content.includes(\"ФАП\") &&\n        !x.content.includes(\"ТРАП\")\n      )\n      .flatMap((x: any) => x.files);\n\n    return files\n      .filter((x: any) => x.kind === \"video\")\n      .map((x: any) => {\n          return {\n            source: x.full,\n            name: x.name,\n            poster: x.thumbnail\n          }\n        }\n      );\n  }\n\n  async setPlaylist() {\n    this.setState({playlist: []});\n\n    const playlist = await this.fetchPlaylist();\n\n    this.setState({\n      playlist: Utils.shuffle(playlist),\n      cursor: 0\n    });\n  }\n\n  async componentDidUpdate(_: any, prevState: Readonly<State>) {\n    if (this.state.board === prevState.board)\n      return;\n\n    await this.setPlaylist();\n  }\n\n  async componentDidMount() {\n    await this.setPlaylist();\n  }\n\n  render() {\n    const {playlist, cursor} = this.state;\n    const video = playlist[cursor];\n    \n    if (!video)\n      return \"Loading...\";\n\n    return (\n      <S.AppStyle>\n        {\n          [\"b\", \"mu\", \"mov\", \"vg\"].map(board => {\n              return (\n                <S.AppTextStyle>\n              <span\n                onClick={() => this.setState({board: board})}\n                style={{color: this.state.board === board ? \"hotpink\" : \"orange\"}}\n              >\n              {`/${board}/`}\n              </span>\n                </S.AppTextStyle>\n              )\n            }\n          )\n        }\n\n        <Player\n          source={video.source}\n          name={video.name}\n          poster={video.poster}\n          playing={this.state.playing}\n          looping={this.state.looping}\n          onPlay={this.onPlay.bind(this)}\n          onPause={this.onPause.bind(this)}\n          moveCursor={this.moveCursor.bind(this)}\n        />\n\n        <Controls\n          source={video.source}\n          playing={this.state.playing}\n          looping={this.state.looping}\n          moveCursor={this.moveCursor.bind(this)}\n          toggleLoop={this.toggleLoop.bind(this)}\n        />\n      </S.AppStyle>\n    );\n  }\n}\n\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(<App/>, document.getElementById(\"root\"));"],"sourceRoot":""}