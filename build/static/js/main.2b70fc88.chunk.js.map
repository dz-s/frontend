{"version":3,"sources":["components/App.styled.ts","components/Player.styled.ts","utils.ts","components/Player.tsx","components/Controls.styled.ts","components/Controls.tsx","entities/file.ts","entities/thread.ts","components/App.tsx","index.tsx"],"names":["AppStyle","styled","div","AppTextStyle","PlayerStyle","PlayerTextStyle","url","fetch","method","response","contentLength","headers","get","parseInt","KB","i","Math","floor","log","parseFloat","pow","toFixed","Player","props","ref","React","createRef","state","autoplay","volume","size","this","current","node","getVideoNode","muted","setState","prevProps","media","full","playing","Utils","fetchSize","play","pause","playsInline","key","controls","autoPlay","loop","looping","preload","onPlay","onPause","onEnded","moveCursor","onError","onVolumeChange","poster","thumbnail","style","maxHeight","minHeight","maxWidth","borderRadius","src","name","formatSize","href","target","textDecoration","Component","ControlsStyle","ControlsTextStyle","Controls","onClick","toggleLoop","color","source","download","File","kind","Thread","id","CORS","BASE","DEFAULT_BOARD","App","board","threads","threadsCursor","playlist","playlistCursor","isIOS","navigator","platform","test","document","addEventListener","handleKeyDown","bind","fetchThreads","then","continuousPreload","e","tagName","code","delta","cursor","length","x","json","hasOwnProperty","map","thread","posts","replies","flatMap","post","files","file","filter","endsWith","console","fetchFiles","shuffle","Promise","resolve","setTimeout","_","prevState","a","video","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.2b70fc88.chunk.js","sourcesContent":["import styled from \"styled-components\";\n\nconst AppStyle = styled.div`\n  height: 100%;\n  width: 100%;\n  display: block;\n  margin: 0 auto;\n  text-align: center;\n  overflow: hidden;\n`;\n\nconst AppTextStyle = styled.div`\n  display: inline-block;\n  color: hotpink;\n  letter-spacing: 1px;\n  margin-right: 1rem;\n`;\n\nexport {AppStyle, AppTextStyle};","import styled from \"styled-components\";\n\nconst PlayerStyle = styled.div`\n  position: relative;\n  margin-left: auto;\n  margin-right: auto;\n  margin-top: 2.5vh;\n`;\n\nconst PlayerTextStyle = styled.div`\n  font-family: \"Roboto\", sans-serif;\n`;\n\nexport {PlayerStyle, PlayerTextStyle};","export default class {\n  static async fetchSize(url: string): Promise<number> {\n    const response = await fetch(`https://cors.x7.workers.dev/${url}`, {method: \"HEAD\"});\n    const contentLength = response.headers.get(\"content-length\");\n    return parseInt(contentLength!);\n  }\n\n  static formatSize(KB: number): string {\n    if (KB === 0)\n      return \"0 Bytes\";\n\n    const SIZES = [\"Bytes\", \"KB\", \"MB\"];\n    const MB = 1000;\n    const i = Math.floor(Math.log(KB) / Math.log(MB));\n    return `${parseFloat((KB / Math.pow(MB, i)).toFixed(2))} ${SIZES[i]}`;\n  }\n}","import React from \"react\";\nimport * as S from \"./Player.styled\";\nimport File from \"../entities/file\";\nimport Utils from \"../utils\";\n\ninterface Props {\n  media: File;\n\n  playing: boolean;\n  looping: boolean;\n\n  onPlay: Function;\n  onPause: Function;\n  moveCursor: Function;\n}\n\ninterface State {\n  autoplay: boolean;\n  volume: number;\n  size: number;\n}\n\nclass Player extends React.Component<Props, State> {\n  ref: React.RefObject<HTMLVideoElement>;\n\n  constructor(props: Props) {\n    super(props);\n\n    this.ref = React.createRef<HTMLVideoElement>();\n\n    this.state = {\n      autoplay: false,\n      volume: 1.00,\n      size: 0\n    };\n  }\n\n  getVideoNode(): HTMLVideoElement | null {\n    return this.ref.current;\n  }\n\n  onVolumeChange() {\n    const node = this.getVideoNode();\n    if (!node)\n      return;\n\n    if (node.muted)\n      this.setState({volume: 0});\n    else\n      this.setState({volume: node.volume})\n  }\n\n  async componentDidUpdate(prevProps: Props) {\n    if (prevProps.media.full === this.props.media.full)\n      return;\n\n    if (this.props.playing && !this.state.autoplay)\n      this.setState({autoplay: true});\n\n    this.setState({size: await Utils.fetchSize(this.props.media.full)});\n\n    const node = this.getVideoNode();\n    if (!node)\n      return;\n\n    this.props.playing ? node.play() : node.pause();\n    node.volume = this.state.volume;\n  }\n\n  async componentDidMount() {\n    this.setState({size: await Utils.fetchSize(this.props.media.full)});\n  }\n\n  render() {\n    return (\n      <S.PlayerStyle>\n        <video\n          playsInline={true}\n          ref={this.ref}\n          key={this.props.media.full}\n          controls={true}\n          autoPlay={this.state.autoplay}\n          loop={this.props.looping}\n          muted={false}\n          preload={\"auto\"}\n          onPlay={() => this.props.onPlay()}\n          onPause={() => this.props.onPause()}\n          onEnded={() => this.props.moveCursor(1)}\n          onError={() => this.props.moveCursor(1)}\n          onVolumeChange={() => this.onVolumeChange()}\n          poster={this.props.media.thumbnail}\n          style={\n            {\n              maxHeight: \"70vh\",\n              minHeight: \"40vh\",\n              maxWidth: \"90vw\",\n              borderRadius: \"5px\"\n            }\n          }\n        >\n          <source src={this.props.media.full}/>\n        </video>\n\n        <S.PlayerTextStyle>\n          {this.props.media.name} | {Utils.formatSize(this.state.size)}\n        </S.PlayerTextStyle>\n\n        <S.PlayerTextStyle>\n          <a\n            href={`https://www.google.com/searchbyimage?image_url=${this.props.media.thumbnail}`}\n            target={\"_blank\"}\n            style={{textDecoration: \"none\"}}\n          >\n            ðŸ”Ž\n          </a>\n        </S.PlayerTextStyle>\n      </S.PlayerStyle>\n    )\n  }\n}\n\n\nexport default Player;\n","import styled from \"styled-components\";\n\nconst ControlsStyle = styled.div`\n  text-align: center;\n  position: fixed;\n  bottom: 5vh;\n  left: 50%;\n  transform: translateX(-50%);\n`;\n\nconst ControlsTextStyle = styled.div`\n  color: hotpink;\n  letter-spacing: 1px;\n  margin-right: 1rem;\n  display: inline-block;\n\n  &:hover {\n    color: orange;\n  }\n  &:link {\n    color: hotpink;\n  }\n  &:visited {\n    color: red;\n  }\n`;\n\nexport {ControlsStyle, ControlsTextStyle};","import React from \"react\";\nimport * as S from \"./Controls.styled\";\n\n\ninterface Props {\n  source: string;\n  playing: boolean;\n  looping: boolean\n\n  moveCursor: Function;\n  toggleLoop: Function;\n}\n\ninterface State {\n}\n\nclass Controls extends React.Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n\n    this.state = {}\n  }\n\n  render() {\n    return (\n      <S.ControlsStyle>\n        <S.ControlsTextStyle>\n                    <span onClick={() => this.props.moveCursor(-1)}>\n                    {\"â—€\"}\n                    </span>\n        </S.ControlsTextStyle>\n\n        <S.ControlsTextStyle>\n          |\n        </S.ControlsTextStyle>\n\n        <S.ControlsTextStyle>\n                    <span onClick={() => this.props.moveCursor(1)}>\n                    {\"â–¶\"}\n                    </span>\n        </S.ControlsTextStyle>\n\n        <br/>\n        <br/>\n\n        <S.ControlsTextStyle>\n          <span onClick={() => this.props.toggleLoop()}\n                style={{color: this.props.looping ? \"hotpink\" : \"orange\"}}>\n            {this.props.looping ? \"LOOPING\" : \"LOOP\"}\n          </span>\n        </S.ControlsTextStyle>\n\n        <S.ControlsTextStyle>\n          <a\n            href={this.props.source}\n            download\n            target={\"_blank\"}\n            style={\n              {\n                color: \"hotpink\",\n                textDecoration: \"none\"\n              }\n            }\n          >\n            DOWNLOAD\n          </a>\n        </S.ControlsTextStyle>\n      </S.ControlsStyle>\n    )\n  }\n}\n\nexport default Controls;","export default class File {\n  full: string;\n  thumbnail: string;\n  kind: string;\n  name: string;\n\n  constructor(full: string, thumbnail: string, kind: string, name: string) {\n    this.full = full;\n    this.thumbnail = thumbnail;\n    this.kind = kind;\n    this.name = name;\n  }\n}","export default class Thread {\n  id: number;\n\n  constructor(id: number) {\n    this.id = id;\n  }\n}","import React from \"react\";\nimport shuffle from \"@tinkoff/utils/array/shuffle\";\nimport * as S from \"./App.styled\";\nimport Player from \"./Player\";\nimport Controls from \"./Controls\";\nimport File from \"../entities/file\";\nimport Thread from \"../entities/thread\";\n\nconst CORS = \"https://cors.x7.workers.dev\";\nconst BASE = \"https://one.karasique.io\";\nconst DEFAULT_BOARD = \"b\";\n\ninterface State {\n  playing: boolean;\n  looping: boolean;\n\n  board: string;\n\n  threads: Array<Thread>;\n  threadsCursor: number;\n\n  playlist: Array<File>;\n  playlistCursor: number;\n\n  isIOS: boolean;\n}\n\nclass App extends React.Component<any, State> {\n  constructor(props: any) {\n    super(props);\n\n    this.state = {\n      playing: false,\n      looping: true,\n\n      board: DEFAULT_BOARD,\n\n      threads: [],\n      threadsCursor: 0,\n\n      playlist: [],\n      playlistCursor: 0,\n\n      isIOS: !!navigator.platform && /iPad|iPhone|iPod/.test(navigator.platform)\n    };\n\n    document.addEventListener(\"keydown\", this.handleKeyDown.bind(this));\n\n    this.fetchThreads(this.state.board)\n      .then(threads => {\n        this.setState({threads: threads});\n        return this.continuousPreload()\n      });\n  }\n\n  handleKeyDown(e: KeyboardEvent) {\n    if ((e.target! as HTMLElement).tagName === \"VIDEO\")\n      return;\n\n    switch (e.code) {\n      case \"ArrowLeft\":\n        this.moveCursor(-1);\n        break;\n      case \"ArrowRight\":\n        this.moveCursor(1);\n        break;\n      case \"Space\":\n        this.state.playing ? this.onPause() : this.onPlay();\n        break;\n    }\n  }\n\n  onPlay() {\n    this.setState({playing: true});\n  }\n\n  onPause() {\n    this.setState({playing: false});\n  }\n\n  moveCursor(delta: number) {\n    const cursor = this.state.playlistCursor + delta;\n\n    if (cursor < 0 || cursor >= this.state.playlist.length)\n      return;\n\n    this.setState({playlistCursor: cursor});\n  }\n\n  toggleLoop() {\n    this.setState({looping: !this.state.looping})\n  }\n\n  async fetchThreads(board: string): Promise<Array<Thread>> {\n    return await fetch(`${CORS}/${BASE}/0/${board}`)\n      .then(x => x.json())\n      .then(x => x.hasOwnProperty(\"error\") ? [] : x)\n      .then(x => x.map((thread: any) => new Thread(thread.id)));\n  }\n\n  async fetchFiles(board: string, thread: Thread): Promise<Array<File>> {\n    const replies = await fetch(`${CORS}/${BASE}/0/${board}/${thread.id}`)\n      .then(x => x.json())\n      .then(x => x.hasOwnProperty(\"error\") ? [] : x.posts);\n\n    return replies\n      .flatMap((post: any) => post.files.map((file: any) => new File(file.full, file.thumbnail, file.kind, file.name)))\n      .filter((file: File) => file.kind === \"video\")\n      .filter((file: File) => this.state.isIOS ? file.full.endsWith(\"mp4\") : true);\n  }\n\n  async continuousPreload() {\n    while (this.state.threadsCursor < this.state.threads.length) {\n      console.log(this.state.playlist.length);\n\n      const thread = this.state.threads[this.state.threadsCursor];\n      const files = await this.fetchFiles(this.state.board, thread);\n\n      this.setState({\n        playlist: [...this.state.playlist, ...shuffle(files)],\n        threadsCursor: this.state.threadsCursor + 1\n      });\n\n      await new Promise(resolve => setTimeout(resolve, 500));\n    }\n  }\n\n  async componentDidUpdate(_: any, prevState: State) {\n    if (prevState.board === this.state.board)\n      return;\n\n    this.setState({playlist: []});\n    this.fetchThreads(this.state.board)\n      .then(async threads => {\n        if (threads.length === 0)\n          return;\n\n        const files = await this.fetchFiles(this.state.board, threads[0]);\n\n        this.setState({\n          threads: shuffle(threads),\n          threadsCursor: 0,\n          playlist: files,\n          playlistCursor: 0,\n        })\n      });\n  }\n\n  render() {\n    const {playlist, playlistCursor} = this.state;\n    const video = playlist[playlistCursor];\n\n    if (!video)\n      return \"Loading...\";\n\n    return (\n      <S.AppStyle>\n        {\n          [\"b\", \"mu\", \"mov\", \"vg\"].map(board => {\n              return (\n                <S.AppTextStyle key={board}>\n                  <span\n                    onClick={() => this.setState({board: board})}\n                    style={{color: this.state.board === board ? \"hotpink\" : \"orange\"}}\n                  >\n                  {`/${board}/`}\n                  </span>\n                </S.AppTextStyle>\n              )\n            }\n          )\n        }\n\n        <Player\n          media={video}\n          playing={this.state.playing}\n          looping={this.state.looping}\n          onPlay={this.onPlay.bind(this)}\n          onPause={this.onPause.bind(this)}\n          moveCursor={this.moveCursor.bind(this)}\n        />\n\n        <Controls\n          source={video.full}\n          playing={this.state.playing}\n          looping={this.state.looping}\n          moveCursor={this.moveCursor.bind(this)}\n          toggleLoop={this.toggleLoop.bind(this)}\n        />\n      </S.AppStyle>\n    );\n  }\n}\n\nexport default App;","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./components/App\";\n\nReactDOM.render(<App/>, document.getElementById(\"root\"));"],"sourceRoot":""}